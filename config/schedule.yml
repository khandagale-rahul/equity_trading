# Sidekiq-cron schedule for Upstox Market Data Service and Holdings Sync
# Times are in IST (configured in config/application.rb)

start_market_data:
  cron: "15 9 * * 1-5"
  class: "Upstox::StartWebsocketConnectionJob"
  queue: "market_data"
  description: "Start Upstox WebSocket market data feed at market open"

ScheduleStrategyExecutionJob:
  cron: "15 9 * * 1-5"
  class: "ScheduleStrategyExecutionJob"
  queue: "default"
  description: "Execute entry rules for all deployed strategies at market open"

stop_market_data:
  cron: "30 15 * * 1-5"
  class: "Upstox::StopWebsocketConnectionJob"
  queue: "market_data"
  description: "Stop Upstox WebSocket market data feed at market close"

health_check_market_data:
  cron: "*/2 9-15 * * 1-5"
  class: "Upstox::HealthCheckWebsocketConnectionJob"
  queue: "market_data"
  description: "Health check to ensure market data service is running during trading hours"

sync_zerodha_holdings:
  cron: "0 8,16 * * 1-5"
  class: "Zerodha::SyncHoldingsJob"
  queue: "default"
  description: "Sync holdings from Zerodha for all authorized users"

sync_upstox_instrument_history:
  cron: "15 9 * * 1-5"
  class: "Upstox::SyncInstrumentHistoryJob"
  queue: "default"
  description: "Sync daily historical candle data for all Upstox instruments"

cleanup_job_logs:
  cron: "0 8 * * *"
  class: "CleanupJobLogsJob"
  queue: "default"
  description: "Clean up old job log files (older than 7 days) using rake task"
