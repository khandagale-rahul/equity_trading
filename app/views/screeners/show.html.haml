%p{style: "color: green"}= notice

- content_for :title, "Screener - #{@screener.name}"

.card
  .card-header
    %h1
      = @screener.name
      Screener
    .text-muted
      Status:
      - if @screener.active
        %span.badge.bg-success Active
      - else
        %span.badge.bg-secondary Inactive
  .card-body
    %table.table.table-bordered
      %tbody
        %tr
          %th{style: "width: 30%"} Strategy Name
          %td= @screener.name
        %tr
          %th Status
          %td
            - if @screener.active
              %span.badge.bg-success Active
            - else
              %span.badge.bg-secondary Inactive
        %tr
          %th Rules
          %td
            %pre.bg-light.p-2.rounded= @screener.rules
        %tr
          %th Result
          %td
            - if @master_instruments.present?
              .row
                .float-right
                  = link_to scan_screener_path(@screener), class: "btn btn-warning me-2" do
                    %i.fas.fa-edit.me-1
                    Scan Again
              %br
              .row
                .table-responsive
                  %table.table.table-bordered.table-striped.table-hover
                    %thead
                      %tr
                        %th No.
                        %th Name
                        %th Exchange
                        %th Exchange Token
                        %th Last Traded Price
                        %th Changes %
                    %tbody
                      - if @master_instruments.any?
                        - @master_instruments.each.with_index do |master_instrument, index|
                          %tr
                            %td= index + 1
                            %td= master_instrument.name
                            %td= master_instrument.exchange
                            %td= master_instrument.exchange_token
                            %td= display_ltp(master_instrument)
                            %td= display_price_change(master_instrument)
                      - else
                        %tr
                          %td.text-center{colspan: 6}
                            %em No master instruments found
            - else
              = link_to scan_screener_path(@screener), class: "btn btn-warning me-2" do
                %i.fas.fa-edit.me-1
                Scan
  .card-footer
    .float-start
      = link_to edit_screener_path(@screener), class: "btn btn-warning me-2" do
        %i.fas.fa-edit.me-1
        Edit
      = link_to screeners_path, class: "btn btn-secondary me-2" do
        %i.fas.fa-arrow-left.me-1
        Back
    .float-end
      = button_to @screener, method: :delete, class: "btn btn-danger", data: { confirm: "Are you sure you want to delete this screener?" } do
        %i.fas.fa-trash.me-1
        Delete
